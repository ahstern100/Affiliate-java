name: Java CI with Maven and Run

# מגדיר מתי זרימת העבודה תופעל - במקרה זה, בכל Push לענף main
on:
  workflow_dispatch:

# מגדיר את המשימות (Jobs) שיתבצעו
jobs:
  build_and_run:
    # מגדיר את מערכת ההפעלה של השרת שיריץ את המשימה
    runs-on: ubuntu-latest

    # מגדיר את הצעדים (Steps) של המשימה
    steps:
    
    # 1. צ'ק-אאוט: מוריד את קוד המאגר שלך לשרת
    - uses: actions/checkout@v4

    # 2. הגדרת ג'אווה: מכין את סביבת הג'אווה (JDK 17)
    - name: Set up JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
        cache: maven # שמירת מטמון עבור מייבן כדי להאיץ ריצות עתידיות

    # 3. בנייה: מריץ את מייבן כדי לבנות את הפרויקט (קומפילציה, בדיקות)
    - name: Build with Maven
      run: mvn -B package --file pom.xml


    # 4. הרצה: מריץ את קוד הג'אווה שלך באמצעות Maven
    - name: Run Main Class via Maven
      run: |
        echo "Running the Java main class with Maven..."
        # הפקודה הבאה משתמשת בפלאגין Exec של Maven כדי להריץ מחלקה ספציפית
        mvn exec:java -Dexec.mainClass="com.example.myproject.MainApp"

    # (אופציונלי) אם אתה בונה קובץ JAR:
    # - name: Execute JAR file
    #   run: java -jar target/MyJavaSyncProject-1.0-SNAPSHOT.jar
